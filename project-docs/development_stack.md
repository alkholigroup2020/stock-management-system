# Stock Management System - Development Stack

**Project:** Stock Management System v1  
**Document Version:** 1.1  
**Date:** November 2, 2025  
**Status:** Finalized

---

## Executive Summary

This document defines the complete technology stack for the Stock Management System MVP. All decisions have been finalized and agreed upon.

**Core Architecture:**
- **Type:** Single-page Application (SPA) with API routes
- **Frontend Framework:** Nuxt 3
- **Progressive Web App:** Enabled (installable, offline-aware)
- **Database:** PostgreSQL (Supabase)
- **Hosting:** Vercel + Supabase (Cloud)
- **Deployment:** Single monolithic Nuxt app

---

## 1. Frontend Stack

### 1.1 Core Framework
- **Nuxt 3** (latest stable)
  - Mode: SPA (`ssr: false`)
  - TypeScript enabled
  - Auto-imports enabled
  - File-based routing

### 1.2 UI & Styling
- **Nuxt UI** - Component library
  - Pre-built form components
  - Modal, toast notifications
  - Tables and data display
- **Tailwind CSS v4** - Utility-first styling
  - Via `@nuxtjs/tailwindcss` module
  - Custom theme for SAR currency formatting
  - RTL support prepared (future)
  - **Brand Colors** (defined in `app/assets/css/main.css` using `@theme` directive):
    - **Primary (Navy Blue):** #000046 - Used for primary brand elements, headings, primary buttons
    - **Secondary (Emerald Green):** #45cf7b - Used for success states, secondary actions, accents
    - Both colors available in shades 50-950 (e.g., `navy-500`, `emerald-400`)
    - Usage: `text-navy-500`, `bg-emerald-400`, `border-navy-600`, etc.

### 1.3 State Management
- **Pinia** - Official Vue state management
  - Stores for:
    - User session & authentication
    - Current active period
    - Global UI state (modals, toasts)
    - Form state persistence

### 1.4 Form Handling
- **Nuxt UI Forms** - Built-in form components
- **Zod** - Schema validation
  - Shared schemas between frontend/backend
  - Type-safe validation
  - Integration with Prisma types

### 1.5 Date/Time Library
- **Day.js** - Lightweight date manipulation
  - Locale: Arabic (ar-sa) for SAR region
  - Plugins: 
    - `customParseFormat`
    - `utc`
    - `timezone`
  - Format: ISO 8601 for API, localized for UI

### 1.6 Utilities
- **VueUse** - Composition utilities
  - `@vueuse/core` for common composables
  - Used for: localStorage, debounce, date formatting

### 1.7 Progressive Web App (PWA)
- **@vite-pwa/nuxt** - PWA module for Nuxt
  - Level: Basic PWA (Level 1)
  - Service Worker: Auto-generated by Vite PWA
  - Offline Strategy: Cache UI assets, friendly offline handling
  - Manifest: Installable app with custom icons
  
**PWA Features:**
- âœ… Installable (Add to Home Screen)
- âœ… Offline UI with clear messaging
- âœ… Cached static assets (CSS, JS, images)
- âœ… App-like experience (full-screen, no browser chrome)
- âœ… Custom splash screen
- âœ… Auto-update on new deployment

**Offline Behavior:**
- **Works Offline:** View cached pages, previously loaded data, interface navigation
- **Requires Connection:** Post deliveries/issues, fetch fresh data, period close
- **User Experience:** Clear "You're offline" banner, disabled buttons with tooltips, green "Back online" notification

**Icons Required:**
- `public/icon-192.png` (192x192 pixels)
- `public/icon-512.png` (512x512 pixels)
- `public/favicon.ico`

**Configuration:**
```typescript
// nuxt.config.ts
pwa: {
  registerType: 'autoUpdate',
  manifest: {
    name: 'Stock Management System',
    short_name: 'FoodStock',
    description: 'Stock control and inventory management',
    theme_color: '#ffffff',
    background_color: '#ffffff',
    display: 'standalone',
    orientation: 'portrait',
    icons: [...]
  },
  workbox: {
    navigateFallback: '/',
    globPatterns: ['**/*.{js,css,html,png,svg,ico}']
  }
}
```

**Future Enhancements (Post-MVP):**
- Level 2: Background sync for queued requests
- Level 3: Full offline mode with local database
- Push notifications for period reminders
- Web Share API for report exports

---

## 2. Backend Stack

### 2.1 API Layer
- **Nuxt Server Routes (Nitro/H3)** - Built-in server
  - Location: `/server/api/`
  - RESTful endpoints
  - Serverless-ready (runs on Vercel)

### 2.2 Database
- **PostgreSQL 15+** (via Supabase)
  - Connection pooling: Supabase handles
  - Backups: Daily automatic (7-day retention on free tier)
  - Extensions: pgcrypto for UUIDs

### 2.3 ORM
- **Prisma** - Type-safe database client
  - Schema location: `/prisma/schema.prisma`
  - Migrations: Prisma Migrate
  - Client generation: TypeScript types auto-generated
  - Connection: Direct via DATABASE_URL

### 2.4 Database Access Pattern
**Hybrid Approach:**

1. **Direct Supabase Client** (for simple reads)
   ```typescript
   // Fast, leverages RLS
   const items = await supabase.from('items').select('*')
   ```

2. **API Routes via Prisma** (for business logic)
   ```typescript
   // Complex operations: WAC calculations, validations
   POST /api/deliveries/post
   POST /api/issues/post
   POST /api/periods/close
   ```

**Rationale:**
- RLS policies for read permissions (performance)
- Server-side API routes for:
  - WAC calculations
  - No negative stock validation
  - Period state management
  - Audit trail creation

---

## 3. Authentication & Authorization

### 3.1 Authentication Strategy
- **Custom Auth with Nuxt**
  - Library: `nuxt-auth-utils` or custom implementation
  - JWT tokens stored in httpOnly cookies
  - Session management via Nuxt middleware

### 3.2 Authorization
- **Role-Based Access Control (RBAC)**
  - Roles: `OPERATOR`, `SUPERVISOR`, `ADMIN`
  - Stored in: User table (role column)
  - Enforced at:
    - Middleware level (page access)
    - API route level (operation permissions)
    - UI level (button visibility)

### 3.3 Permissions Matrix

| Feature | Operator | Supervisor | Admin |
|---------|----------|------------|-------|
| Dashboard (view) | âœ… | âœ… | âœ… |
| POB (enter/edit) | âœ… | âœ… | âœ… |
| Items & Prices (create/edit) | âŒ | âŒ | âœ… |
| Deliveries (post) | âœ… | âœ… | âœ… |
| Issues (post) | âœ… | âœ… | âœ… |
| NCR (create/update) | âœ… | âœ… | âœ… |
| Stock Now (view) | âœ… | âœ… | âœ… |
| Reconciliations (edit) | âŒ | âœ… | âœ… |
| Period Close | âŒ | âŒ | âœ… |
| User & Role management | âŒ | âŒ | âœ… |

### 3.4 Security Features
- **Audit Trail:** All mutations logged (who/when/what)
- **HTTPS:** Enforced by Vercel
- **Rate Limiting:** 60 requests/minute per user
- **Input Validation:** Zod schemas on all endpoints
- **SQL Injection Prevention:** Prisma parameterized queries

---

## 4. Deployment & Hosting

### 4.1 Platform
- **Vercel** - Frontend + API hosting
  - Plan: Free tier (sufficient for MVP)
  - Region: Auto (globally distributed)
  - Deployment: Git-based (auto-deploy on push to main)

### 4.2 Database Hosting
- **Supabase** - PostgreSQL hosting
  - Plan: Free tier
  - Region: Closest to Saudi Arabia (likely Singapore/Mumbai)
  - Features used:
    - PostgreSQL database (500 MB)
    - Database GUI (Supabase Studio)
    - Daily backups (7-day retention)

### 4.3 Free Tier Limits

**Vercel:**
- Bandwidth: 100 GB/month (sufficient for 5-20 users)
- Function execution: 100 GB-hours/month
- Function duration: 10s max per request
- Build minutes: 6,000/month

**Supabase:**
- Database: 500 MB storage (6+ months data for single site)
- API requests: Unlimited
- Monthly Active Users: 50,000
- Database pausing: After 1 week inactivity (acceptable for pilot)

### 4.4 Environment Variables

**Vercel Environment Variables:**
```bash
# Database
DATABASE_URL=postgresql://[user]:[password]@[host]/[database]

# Supabase
SUPABASE_URL=https://[project].supabase.co
SUPABASE_ANON_KEY=[anon-key]
SUPABASE_SERVICE_KEY=[service-key]

# App Config
NUXT_PUBLIC_SITE_URL=https://foodstock.vercel.app
NUXT_PUBLIC_CURRENCY=SAR
NUXT_PUBLIC_API_BASE=/api

# Auth
AUTH_SECRET=[generated-secret]
AUTH_ORIGIN=https://foodstock.vercel.app
```

---

## 5. Development Workflow

### 5.1 Git Strategy
- **Repository:** Single monorepo
- **Branching:**
  - `main` â†’ Production (auto-deploy to Vercel)
  - `feature/*` â†’ Feature branches (Vercel preview deployments)
- **No staging environment** for MVP
- **Preview deployments:** Automatic on pull requests

### 5.2 Development Tools
- **Package Manager:** pnpm (faster, efficient)
- **Node Version:** 18+ (LTS)
- **IDE:** VS Code recommended
- **Extensions:**
  - Volar (Vue Language Features)
  - Prisma (schema formatting)
  - Tailwind CSS IntelliSense
  - ESLint

### 5.3 Code Quality
- **Linting:** ESLint + Prettier
- **Type Checking:** TypeScript strict mode
- **Git Hooks:** Husky (optional for team)
  - Pre-commit: Lint staged files
  - Pre-push: Type check

---

## 6. Testing Strategy

### 6.1 Testing Levels (Basic for MVP)

**Unit Tests:**
- **Target:** Business logic only
- **Tool:** Vitest
- **Coverage:**
  - WAC calculation functions
  - Reconciliation math
  - Validation functions
- **Location:** `tests/unit/`

**API Tests:**
- **Target:** Critical endpoints
- **Tool:** Vitest + h3 test utils
- **Coverage:**
  - POST /api/deliveries/post
  - POST /api/issues/post
  - POST /api/periods/close
  - Validation error responses
- **Location:** `tests/api/`

**No E2E tests for MVP** - Manual testing during pilot

### 6.2 Test Commands
```bash
# Run all tests
pnpm test

# Run unit tests
pnpm test:unit

# Run API tests
pnpm test:api

# Test coverage
pnpm test:coverage
```

---

## 7. Error Handling & Logging

### 7.1 Error Handling
- **Client-side:** Try-catch with user-friendly messages
- **Server-side:** Structured error responses
  ```json
  {
    "error": true,
    "code": "NEGATIVE_STOCK_BLOCKED",
    "message": "Cannot issue more than on-hand quantity",
    "details": { "itemId": 123, "available": 50, "requested": 75 }
  }
  ```

### 7.2 Logging Strategy (MVP)
- **Development:** Console logs
- **Production:**
  - Vercel function logs (built-in)
  - Supabase query logs (via Studio)
  - No external logging service for MVP
  - **Future:** Add Sentry if issues arise

### 7.3 Error Codes
Standard error codes across all API endpoints:
- `VALIDATION_FAILED` - Input validation error
- `PERIOD_CLOSED` - Cannot modify closed period
- `NEGATIVE_STOCK_BLOCKED` - Issue would create negative stock
- `NOT_FOUND` - Resource not found
- `FORBIDDEN` - Insufficient permissions
- `CONFLICT` - Concurrent modification conflict
- `INTERNAL_ERROR` - Server error

---

## 8. Type Safety & Code Generation

### 8.1 Type Generation Flow
```
Prisma Schema â†’ Prisma Generate â†’ TypeScript Types
                                          â†“
                                    Zod Schemas (manual)
                                          â†“
                                    API Validation + Form Validation
```

### 8.2 Type Safety Level
**Moderate (Not Too Strict):**
- Prisma types: Auto-generated, used everywhere
- Zod schemas: Manual creation for API/forms
- No automatic Zod generation from Prisma
- Allow `any` in rare edge cases (documented)

### 8.3 Shared Types Location
```
/types/
  â”œâ”€â”€ api.ts          # API request/response types
  â”œâ”€â”€ database.ts     # Re-exported Prisma types
  â”œâ”€â”€ auth.ts         # User, role types
  â””â”€â”€ business.ts     # WAC, reconciliation types
```

---

## 9. Configuration Files

### 9.1 Key Configuration Files

**nuxt.config.ts**
```typescript
export default defineNuxtConfig({
  ssr: false, // SPA mode
  modules: [
    '@nuxt/ui',
    '@pinia/nuxt',
    '@nuxtjs/tailwindcss',
    '@vite-pwa/nuxt',
  ],
  pwa: {
    registerType: 'autoUpdate',
    manifest: {
      name: 'Stock Management System',
      short_name: 'FoodStock',
      description: 'Stock control and inventory management',
      theme_color: '#ffffff',
      background_color: '#ffffff',
      display: 'standalone',
      orientation: 'portrait',
      icons: [
        {
          src: '/icon-192.png',
          sizes: '192x192',
          type: 'image/png',
          purpose: 'any maskable'
        },
        {
          src: '/icon-512.png',
          sizes: '512x512',
          type: 'image/png',
          purpose: 'any maskable'
        }
      ]
    },
    workbox: {
      navigateFallback: '/',
      globPatterns: ['**/*.{js,css,html,png,svg,ico}'],
      cleanupOutdatedCaches: true,
      runtimeCaching: [
        {
          urlPattern: /^https:\/\/fonts\.googleapis\.com\/.*/i,
          handler: 'CacheFirst',
          options: {
            cacheName: 'google-fonts-cache',
            expiration: {
              maxEntries: 10,
              maxAgeSeconds: 60 * 60 * 24 * 365 // 1 year
            },
            cacheableResponse: {
              statuses: [0, 200]
            }
          }
        }
      ]
    },
    client: {
      installPrompt: true,
    },
    devOptions: {
      enabled: true,
      type: 'module'
    }
  },
  runtimeConfig: {
    // Private (server-only)
    databaseUrl: process.env.DATABASE_URL,
    supabaseServiceKey: process.env.SUPABASE_SERVICE_KEY,
    authSecret: process.env.AUTH_SECRET,
    
    // Public (client + server)
    public: {
      siteUrl: process.env.NUXT_PUBLIC_SITE_URL,
      currency: 'SAR',
      supabaseUrl: process.env.SUPABASE_URL,
      supabaseAnonKey: process.env.SUPABASE_ANON_KEY,
    }
  },
  devtools: { enabled: true },
})
```

**prisma/schema.prisma**
```prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Models defined per ERD in project docs
```

**package.json** (key scripts)
```json
{
  "scripts": {
    "dev": "nuxt dev",
    "build": "nuxt build",
    "generate": "nuxt generate",
    "preview": "nuxt preview",
    "postinstall": "nuxt prepare && prisma generate",
    "db:migrate": "prisma migrate dev",
    "db:push": "prisma db push",
    "db:studio": "prisma studio",
    "test": "vitest",
    "test:unit": "vitest tests/unit",
    "test:api": "vitest tests/api",
    "lint": "eslint .",
    "typecheck": "nuxt typecheck"
  }
}
```

---

## 10. Performance Targets

### 10.1 Response Time Requirements
| Operation | Target | Critical? |
|-----------|--------|-----------|
| Dashboard load | < 1.5s | Yes |
| Post delivery | < 1s | Yes |
| Post issue | < 1s | Yes |
| Stock Now query | < 500ms | No |
| Period close | < 5s | No |

### 10.2 Optimization Strategies
- **Database:**
  - Indexes on frequently queried fields (periodId, itemId, dates)
  - Connection pooling via Supabase
  - WAC calculations cached in item record
  
- **Frontend:**
  - Lazy load route components
  - Debounce search inputs (300ms)
  - Pagination for large lists (50 items/page)
  - Virtual scrolling if needed (future)

- **API:**
  - Batch operations where possible
  - Minimize round trips (use includes/joins)
  - Cache static data (items list) client-side

---

## 11. Data & Localization

### 11.1 Currency & Formatting
- **Primary Currency:** SAR (Saudi Riyal)
- **Format:** SAR 1,234.56
- **Decimal Places:** 2
- **Tax:** Prices are tax-exclusive (VAT added at period close if needed)

### 11.2 Date/Time
- **Storage:** UTC timestamps in database
- **Display:** Local time (Saudi Arabia - Asia/Riyadh)
- **Format:** DD/MM/YYYY for display, ISO 8601 for API
- **Library:** Day.js with `ar-sa` locale

### 11.3 Units of Measure
- **Supported:** KG (Kilograms), EA (Each/Unit)
- **Display:** Always show unit next to quantity
- **Validation:** Non-negative only, max 4 decimal places

### 11.4 Internationalization (i18n)
- **MVP:** English only
- **Future:** Arabic support via `@nuxtjs/i18n`
- **Prepared:** RTL-ready Tailwind classes

### 11.5 Theme & Brand Colors

**Complete design system documentation:** See `project-docs/UI_DESIGN_GUIDE.md`

**Quick Reference:**
- **Primary Color:** Navy Blue (#000046) - Brand elements, headings, primary buttons
- **Secondary Color:** Emerald Green (#45cf7b) - Success states, secondary actions, accents
- **Configuration:** `app/assets/css/main.css` (single source of truth using Tailwind CSS v4 `@theme` directive)

**Key Rules:**
- ✅ Always use Tailwind color tokens (e.g., `text-navy-500`, `bg-emerald-400`)
- ❌ Never use inline styles with hex colors
- ✅ Support both light and dark modes using `dark:` variant

---

## 12. Business Logic Rules

### 12.1 Core Validations
1. **No Negative Stock:** Issues blocked if qty > on-hand
2. **Period State:** Only OPEN periods accept posts
3. **Unique Item Codes:** Enforced at database level
4. **Date Constraints:** Post dates must be within period dates
5. **WAC Recalculation:** Automatic on every delivery

### 12.2 Key Formulas

**Weighted Average Cost (WAC):**
```typescript
WAC = (oldQty Ã— oldWAC + receivedQty Ã— receiptPrice) Ã· (oldQty + receivedQty)
```

**Consumption:**
```typescript
Consumption = Opening + Receipts - Closing + BackCharges - Credits + Others - Condemnations
```

**Manday Cost:**
```typescript
MandayCost = Consumption Ã· TotalMandays
```

### 12.3 Audit Trail
Every mutation logs:
- `userId` - Who performed action
- `timestamp` - When (UTC)
- `action` - What (CREATE_DELIVERY, POST_ISSUE, etc.)
- `entityId` - Which record
- `changes` - Old/new values (JSON)

---

## 13. Third-Party Dependencies

### 13.1 Core Dependencies
```json
{
  "dependencies": {
    "@nuxt/ui": "^2.x",
    "@pinia/nuxt": "^0.5.x",
    "@prisma/client": "^5.x",
    "dayjs": "^1.11.x",
    "nuxt": "^3.x",
    "zod": "^3.x"
  },
  "devDependencies": {
    "@nuxt/devtools": "latest",
    "@nuxtjs/tailwindcss": "^6.x",
    "@vite-pwa/nuxt": "^0.10.x",
    "eslint": "^8.x",
    "prisma": "^5.x",
    "typescript": "^5.x",
    "vitest": "^1.x"
  }
}
```

### 13.2 Key Packages Purpose
- `@nuxt/ui` - UI component library
- `@pinia/nuxt` - State management
- `@prisma/client` - Database ORM
- `@vite-pwa/nuxt` - Progressive Web App functionality
- `dayjs` - Date manipulation
- `zod` - Schema validation
- `vitest` - Testing framework

---

## 14. Migration Path

### 14.1 From MVP to Scale
**If pilot succeeds and needs to scale:**

**Option 1: Stay on Cloud (Upgrade Tiers)**
- Vercel Pro: $20/month
- Supabase Pro: $25/month
- Total: $45/month
- Supports multiple sites

**Option 2: Migrate to Self-Hosted**
- Export Docker container from Nuxt build
- Run PostgreSQL on own server
- Nginx reverse proxy
- Manual backup scripts
- Cost: Server hardware only

**Migration Strategy:**
1. Use Prisma migrations to export schema
2. `pg_dump` to backup Supabase data
3. Restore to new PostgreSQL instance
4. Update DATABASE_URL
5. Deploy container

### 14.2 Database Migration from Supabase
```bash
# Export schema
prisma migrate dev --create-only

# Dump data
pg_dump $SUPABASE_URL > backup.sql

# Import to new DB
psql $NEW_DATABASE_URL < backup.sql
```

---

## 15. Development Timeline Estimate

### 15.1 MVP Phases (20 Development Days)

**Phase 1: Foundation (5 days)**
- Nuxt project setup
- PWA configuration + icons
- Prisma schema + migrations
- Authentication system
- Base layout + navigation

**Phase 2: Stock Moves (7 days)**
- Items & Prices CRUD
- Post Deliveries (with WAC)
- Post Issues (with validation)
- Stock Now view

**Phase 3: Period Management (5 days)**
- POB entry
- Reconciliations calculation
- Period Close flow
- Dashboard summary

**Phase 4: Polish & Testing (3 days)**
- NCR basic flow
- Unit tests (WAC, validation)
- API tests (critical paths)
- Bug fixes

### 15.2 Post-MVP Enhancements
- Reports & exports (PDF/Excel)
- PRF/PO approval workflow
- Multi-site support
- Advanced reporting
- Mobile-responsive optimization

---

## 16. Success Criteria

### 16.1 Technical Success Metrics
- âœ… All API responses < 1s (95th percentile)
- âœ… Dashboard loads < 1.5s
- âœ… Zero negative stock occurrences
- âœ… 100% uptime during business hours
- âœ… All test suites passing

### 16.2 Business Success Metrics
- âœ… Pilot runs full month without blocking bugs
- âœ… Time to post delivery < 2 minutes (vs Excel baseline)
- âœ… Period close duration < 30 minutes
- âœ… User satisfaction > 4/5 stars
- âœ… Zero data loss incidents

---

## 17. Risk Management

### 17.1 Technical Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| Supabase DB pause on weekends | Low | Cron job ping or upgrade to paid |
| Vercel free tier limits exceeded | Medium | Monitor usage, upgrade if needed |
| WAC calculation bugs | High | Unit tests, Excel validation |
| Data loss (no backups) | Critical | Supabase daily backups enabled |
| Auth vulnerability | High | JWT best practices, rate limiting |

### 17.2 Business Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| User adoption failure | Critical | Training, simple UI, quick wins |
| Excel formula mismatch | High | Validate with sample data |
| Scope creep | Medium | Strict MVP definition, v1.1 backlog |
| Internet outage | Medium | Clear offline messaging, retry logic |

---

## 18. Documentation Requirements

### 18.1 Developer Documentation
- âœ… This stack document
- âœ… API Contract (already exists)
- âœ… Prisma schema comments
- ðŸ”² Setup guide (README.md)
- ðŸ”² Deployment guide

### 18.2 User Documentation
- ðŸ”² User manual (30-min training guide)
- ðŸ”² Quick reference card (1-pager)
- ðŸ”² Video walkthrough (optional)
- ðŸ”² FAQ document

### 18.3 Operational Documentation
- ðŸ”² Backup/restore procedures
- ðŸ”² Monitoring guide
- ðŸ”² Incident response plan
- ðŸ”² User onboarding checklist

---

## 19. Open Questions & Decisions Pending

### 19.1 Confirmed Decisions
âœ… WAC costing method (not FIFO)  
âœ… Single site/store (no transfers)  
âœ… Prices are tax-exclusive  
âœ… Currency: SAR  
âœ… Approvals: Off by default for MVP  
âœ… Internet required (graceful offline handling via PWA)  
âœ… PWA enabled (installable, offline-aware)

### 19.2 To Be Confirmed Before Development
ðŸ”² Admin user seeding strategy (first user creation)  
ðŸ”² Item Master initial data (CSV import or manual entry?)  
ðŸ”² Opening balances for first period  
ðŸ”² Exact pilot site and start date  
ðŸ”² PWA icons design (192x192 and 512x512 app icons)  
ðŸ”² Training schedule  

---

## 20. Contact & Ownership

**Technical Owner:** Fawzy  
**Stakeholders:** Operations, Finance  
**Development Team:** TBD  
**Support:** To be established post-pilot

---

## Appendix A: Folder Structure

```
food-stock-control/
â”œâ”€â”€ .nuxt/                    # Nuxt build output (gitignored)
â”œâ”€â”€ .output/                  # Production build
â”œâ”€â”€ node_modules/
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma         # Database schema
â”‚   â”œâ”€â”€ migrations/           # Migration history
â”‚   â””â”€â”€ seed.ts              # Optional seed data
â”œâ”€â”€ public/                   # Static assets
â”‚   â”œâ”€â”€ icon-192.png         # PWA icon 192x192
â”‚   â”œâ”€â”€ icon-512.png         # PWA icon 512x512
â”‚   â””â”€â”€ favicon.ico          # Browser favicon
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ api/                 # API routes
â”‚   â”‚   â”œâ”€â”€ deliveries/
â”‚   â”‚   â”œâ”€â”€ issues/
â”‚   â”‚   â”œâ”€â”€ periods/
â”‚   â”‚   â”œâ”€â”€ items/
â”‚   â”‚   â””â”€â”€ auth/
â”‚   â”œâ”€â”€ middleware/          # Server middleware (auth)
â”‚   â””â”€â”€ utils/               # Server utilities (WAC calculator)
â”œâ”€â”€ stores/                   # Pinia stores
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ period.ts
â”‚   â””â”€â”€ ui.ts
â”œâ”€â”€ composables/              # Vue composables
â”‚   â”œâ”€â”€ useApi.ts
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â””â”€â”€ useCurrency.ts
â”œâ”€â”€ components/               # Vue components
â”‚   â”œâ”€â”€ delivery/
â”‚   â”œâ”€â”€ issue/
â”‚   â”œâ”€â”€ common/
â”‚   â””â”€â”€ layout/
â”œâ”€â”€ pages/                    # Nuxt pages (auto-routing)
â”‚   â”œâ”€â”€ index.vue            # Dashboard
â”‚   â”œâ”€â”€ deliveries/
â”‚   â”œâ”€â”€ issues/
â”‚   â”œâ”€â”€ stock-now.vue
â”‚   â”œâ”€â”€ reconciliations.vue
â”‚   â””â”€â”€ period-close.vue
â”œâ”€â”€ types/                    # TypeScript types
â”œâ”€â”€ tests/                    # Test files
â”‚   â”œâ”€â”€ unit/
â”‚   â””â”€â”€ api/
â”œâ”€â”€ .env                      # Local environment (gitignored)
â”œâ”€â”€ .gitignore
â”œâ”€â”€ nuxt.config.ts           # Nuxt configuration
â”œâ”€â”€ package.json
â”œâ”€â”€ pnpm-lock.yaml
â”œâ”€â”€ tailwind.config.ts       # Tailwind configuration
â”œâ”€â”€ tsconfig.json            # TypeScript configuration
â””â”€â”€ README.md
```

---

## Appendix B: Quick Start Commands

```bash
# Install dependencies
pnpm install

# Setup database
pnpm db:push

# Run development server
pnpm dev

# Run tests
pnpm test

# Build for production
pnpm build

# Preview production build
pnpm preview

# Open Prisma Studio (DB GUI)
pnpm db:studio
```

---

## Appendix C: Useful Links

- **Nuxt 3 Docs:** https://nuxt.com/docs
- **Nuxt UI Docs:** https://ui.nuxt.com
- **Prisma Docs:** https://www.prisma.io/docs
- **Supabase Docs:** https://supabase.com/docs
- **Vercel Docs:** https://vercel.com/docs
- **Vite PWA Docs:** https://vite-pwa-org.netlify.app/
- **Zod Docs:** https://zod.dev
- **Day.js Docs:** https://day.js.org
- **Pinia Docs:** https://pinia.vuejs.org

---

## Document Change Log

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 1.0 | 2025-11-02 | Initial finalized stack | Fawzy |
| 1.1 | 2025-11-02 | Added PWA configuration and capabilities | Fawzy |

---

**End of Development Stack Document**
